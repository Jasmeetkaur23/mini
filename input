copy start 1000
first stl retadr
cloop jsub rdrec
- lda length
- comp zero
- jeq endfil
- jsub wrrec
- j cloop
endfil lda eof
- sta buffer
- lda three
- sta length
- jsub wrrec
- ldl retadr
- rsub -
eof resw 1
three resw 1
zero resw 1
retadr resw 1
length resw 1
buffer resb 4096
rdrec ldx zero
- lda zero
rloop td input
- jeq rloop
- rd input
- comp zero
- jeq exit
- stch buffer
- tix maxlen
- jlt rloop
exit stx length
- rsub -
input byte x'f1'
maxlen resw 1
wrrec ldx zero
wloop td output
- jeq wloop
- ldch buffer
- wd output
- tix length
- jlt wloop
- rsub -
output byte x'05'
- end first
